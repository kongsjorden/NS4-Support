---
interface Props {
  title: string;
  subtitle?: string;
  showCta?: boolean;
}

const { title, subtitle, showCta = true } = Astro.props;
---

<section class="relative pt-24 pb-8 md:pt-32 md:pb-16 overflow-hidden">
  <!-- Background gradient -->
  <div class="absolute inset-0 bg-gradient-to-b from-primary/8 via-primary/3 to-transparent pointer-events-none"></div>

  <!-- Animated gradient orbs -->
  <div class="absolute top-20 left-1/4 w-[500px] h-[500px] bg-primary/15 rounded-full blur-[100px] pointer-events-none animate-pulse-slow"></div>
  <div class="absolute bottom-0 right-1/3 w-80 h-80 bg-primary/10 rounded-full blur-[80px] pointer-events-none"></div>

  <!-- Grid pattern overlay -->
  <div class="absolute inset-0 opacity-[0.02] pointer-events-none" style="background-image: url('data:image/svg+xml,%3Csvg width=&quot;60&quot; height=&quot;60&quot; viewBox=&quot;0 0 60 60&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;%3E%3Cg fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;%3E%3Cg fill=&quot;%23ffffff&quot; fill-opacity=&quot;1&quot;%3E%3Cpath d=&quot;M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z&quot;/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>

  <div class="max-w-7xl mx-auto px-6 relative">
    <div class="grid lg:grid-cols-2 gap-12 lg:gap-8 items-center">
      <!-- Text Content -->
      <div class="text-center lg:text-left">
        <!-- Badge -->
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-surface/80 backdrop-blur-sm rounded-full border border-border/50 mb-8 animate-in">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>
          </span>
          <span class="text-text-muted text-sm font-medium tracking-wide">For Stage Keyboard Musicians</span>
        </div>

        <!-- Title -->
        <h1 class="font-display font-bold text-4xl md:text-5xl lg:text-6xl xl:text-7xl text-text mb-6 leading-[1.1] tracking-tight animate-in delay-1">
          <span class="block">{title.split(',')[0]}</span>
          {title.includes(',') && (
            <span class="block text-primary">{title.split(',')[1]}</span>
          )}
        </h1>

        <!-- Subtitle -->
        {subtitle && (
          <p class="text-text-muted text-lg md:text-xl leading-relaxed mb-10 max-w-xl mx-auto lg:mx-0 animate-in delay-2">
            {subtitle}
          </p>
        )}

        <!-- CTA Buttons -->
        {showCta && (
          <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start animate-in delay-3">
            <a
              href="https://apps.apple.com"
              target="_blank"
              rel="noopener noreferrer"
              class="group inline-flex items-center justify-center gap-3 px-8 py-4 bg-primary hover:bg-primary-hover text-white font-semibold rounded-2xl transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl hover:shadow-primary/30"
            >
              <svg class="w-6 h-6 transition-transform group-hover:scale-110" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
              </svg>
              Download on App Store
            </a>
            <a
              href="/features"
              class="group inline-flex items-center justify-center gap-2 px-8 py-4 bg-surface/50 hover:bg-surface text-text font-semibold rounded-2xl border border-border/50 hover:border-primary/30 transition-all duration-200 backdrop-blur-sm"
            >
              Explore Features
              <svg class="w-5 h-5 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </a>
          </div>
        )}
      </div>

      <!-- Phone Mockup -->
      <div class="relative flex justify-center lg:justify-end animate-in delay-2">
        <!-- Glow effect behind phone -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[400px] bg-primary/20 rounded-full blur-[80px]"></div>

        <!-- Phone frame -->
        <div class="relative">
          <!-- Phone device -->
          <div class="relative w-[280px] md:w-[320px]">
            <!-- Phone outer frame -->
            <div class="relative bg-gradient-to-b from-zinc-700 to-zinc-900 rounded-[3rem] p-3 shadow-2xl shadow-black/50">
              <!-- Phone inner bezel -->
              <div class="relative bg-black rounded-[2.5rem] overflow-hidden">
                <!-- Dynamic Island / Notch -->
                <div class="absolute top-4 left-1/2 -translate-x-1/2 w-28 h-7 bg-black rounded-full z-10"></div>

                <!-- Screen content - Auto-cycling screenshots -->
                <div class="relative aspect-[9/19.5] overflow-hidden">
                  <div class="phone-carousel absolute inset-0">
                    <img src="/screenshots/performance-mode.png" alt="Performance Mode" class="phone-slide absolute inset-0 w-full h-full object-cover object-top" />
                    <img src="/screenshots/setlist-song.png" alt="Setlist" class="phone-slide absolute inset-0 w-full h-full object-cover object-top" />
                    <img src="/screenshots/programs-browser.png" alt="Programs" class="phone-slide absolute inset-0 w-full h-full object-cover object-top" />
                    <img src="/screenshots/controls-quick.png" alt="Controls" class="phone-slide absolute inset-0 w-full h-full object-cover object-top" />
                    <img src="/screenshots/tempo-metronome.png" alt="Tempo" class="phone-slide absolute inset-0 w-full h-full object-cover object-top" />
                  </div>
                  <!-- Screen reflection overlay -->
                  <div class="absolute inset-0 bg-gradient-to-tr from-transparent via-white/5 to-white/10 pointer-events-none z-10"></div>
                </div>
              </div>
            </div>

            <!-- Phone side button (power) -->
            <div class="absolute right-[-3px] top-32 w-1 h-12 bg-zinc-600 rounded-l"></div>
            <!-- Phone side buttons (volume) -->
            <div class="absolute left-[-3px] top-28 w-1 h-8 bg-zinc-600 rounded-r"></div>
            <div class="absolute left-[-3px] top-40 w-1 h-8 bg-zinc-600 rounded-r"></div>
          </div>

          <!-- Screen indicator dots -->
          <div class="flex justify-center gap-2 mt-4">
            <button class="screen-dot w-2 h-2 rounded-full bg-primary transition-all" data-index="0"></button>
            <button class="screen-dot w-2 h-2 rounded-full bg-text-dim/30 hover:bg-text-dim/50 transition-all" data-index="1"></button>
            <button class="screen-dot w-2 h-2 rounded-full bg-text-dim/30 hover:bg-text-dim/50 transition-all" data-index="2"></button>
            <button class="screen-dot w-2 h-2 rounded-full bg-text-dim/30 hover:bg-text-dim/50 transition-all" data-index="3"></button>
            <button class="screen-dot w-2 h-2 rounded-full bg-text-dim/30 hover:bg-text-dim/50 transition-all" data-index="4"></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Auto-cycling phone screenshots
  const slides = document.querySelectorAll('.phone-slide');
  const dots = document.querySelectorAll('.screen-dot');
  let currentIndex = 0;
  let interval: ReturnType<typeof setInterval>;

  function showSlide(index: number) {
    slides.forEach((slide, i) => {
      (slide as HTMLElement).style.opacity = i === index ? '1' : '0';
      (slide as HTMLElement).style.transition = 'opacity 0.5s ease-in-out';
    });
    dots.forEach((dot, i) => {
      dot.classList.toggle('bg-primary', i === index);
      dot.classList.toggle('bg-text-dim/30', i !== index);
    });
    currentIndex = index;
  }

  function nextSlide() {
    showSlide((currentIndex + 1) % slides.length);
  }

  // Initialize
  slides.forEach((slide, i) => {
    (slide as HTMLElement).style.opacity = i === 0 ? '1' : '0';
  });

  // Auto-advance every 3 seconds
  interval = setInterval(nextSlide, 3000);

  // Click on dots to navigate
  dots.forEach((dot, i) => {
    dot.addEventListener('click', () => {
      clearInterval(interval);
      showSlide(i);
      interval = setInterval(nextSlide, 3000);
    });
  });
</script>

<style>
  .font-display {
    font-family: 'Outfit', sans-serif;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pulseSlow {
    0%, 100% { opacity: 0.15; }
    50% { opacity: 0.25; }
  }

  .animate-in {
    opacity: 0;
    animation: fadeInUp 0.8s ease-out forwards;
  }

  .animate-pulse-slow {
    animation: pulseSlow 4s ease-in-out infinite;
  }

  .delay-1 { animation-delay: 0.15s; }
  .delay-2 { animation-delay: 0.3s; }
  .delay-3 { animation-delay: 0.45s; }
</style>
